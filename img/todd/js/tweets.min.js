(function(a){a.fn.tweet=function(b){function d(a){return Date.parse(a.replace(/^([a-z]{3})( [a-z]{3} \d\d?)(.*)( \d{4})$/i,"$1,$2$4$3"))}function e(a){var b=arguments.length>1?arguments[1]:new Date;var c=parseInt((b.getTime()-a)/1e3,10);var d="";if(c<60){d=c+" seconds ago"}else if(c<120){d="a minute ago"}else if(c<45*60){d=parseInt(c/60,10).toString()+" minutes ago"}else if(c<2*60*60){d="an hour ago"}else if(c<24*60*60){d=""+parseInt(c/3600,10).toString()+" hours ago"}else if(c<48*60*60){d="a day ago"}else{d=parseInt(c/86400,10).toString()+" days ago"}return"About "+d}function f(){var a="https:"==document.location.protocol?"https:":"http:";var b=c.fetch===null?c.count:c.fetch;if(c.list){return a+"//"+c.twitter_api_url+"/1/"+c.username[0]+"/lists/"+c.list+"/statuses.json?per_page="+b+"&callback=?"}else if(c.favorites){return a+"//"+c.twitter_api_url+"/favorites/"+c.username[0]+".json?count="+c.count+"&callback=?"}else if(c.query===null&&c.username.length==1){return a+"//"+c.twitter_api_url+"/1/statuses/user_timeline.json?screen_name="+c.username[0]+"&count="+b+(c.retweets?"&include_rts=1":"")+"&callback=?"}else{var d=c.query||"from:"+c.username.join(" OR from:");return a+"//"+c.twitter_search_url+"/search.json?&q="+encodeURIComponent(d)+"&rpp="+b+"&callback=?"}}var c=a.extend({username:null,list:null,favorites:false,query:null,avatar_size:null,count:5,fetch:null,retweets:true,intro_text:null,outro_text:null,join_text:null,auto_join_text_default:"i said,",auto_join_text_ed:"i",auto_join_text_ing:"i am",auto_join_text_reply:"i replied to",auto_join_text_url:"i was looking at",loading_text:null,refresh_interval:null,twitter_url:"twitter.com",twitter_api_url:"api.twitter.com",twitter_search_url:"search.twitter.com",template:"{avatar}{time}{join}{text}",comparator:function(a,b){return b["tweet_time"]-a["tweet_time"]},filter:function(a){return true}},b);a.fn.extend({linkUrl:function(){var b=[];var c=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????]))/gi;this.each(function(){b.push(this.replace(c,function(a){var b=/^[a-z]+:/i.test(a)?a:"http://"+a;return'<a href="'+b+'">'+a+"</a>"}))});return a(b)},linkUser:function(){var b=[];var d=/[\@]+(\w+)/gi;this.each(function(){b.push(this.replace(d,'@<a href="http://'+c.twitter_url+'/$1">$1</a>'))});return a(b)},linkHash:function(){var b=[];var d=/(?:^| )[\#]+([\w\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff\u0600-\u06ff]+)/gi;var e=c.username&&c.username.length==1?"&from="+c.username.join("%2BOR%2B"):"";this.each(function(){b.push(this.replace(d,' <a href="http://'+c.twitter_search_url+"/search?q=&tag=$1&lang=all"+e+'">#$1</a>'))});return a(b)},capAwesome:function(){var b=[];this.each(function(){b.push(this.replace(/\b(awesome)\b/gi,'<span class="awesome">$1</span>'))});return a(b)},capEpic:function(){var b=[];this.each(function(){b.push(this.replace(/\b(epic)\b/gi,'<span class="epic">$1</span>'))});return a(b)},makeHeart:function(){var b=[];this.each(function(){b.push(this.replace(/(<)+[3]/gi,"<tt class='heart'>&#x2665;</tt>"))});return a(b)}});return this.each(function(b,g){var h=a('<ul class="tweet-list">').appendTo(g);var i='<p class="tweet_intro">'+c.intro_text+"</p>";var j='<p class="tweet_outro">'+c.outro_text+"</p>";var k=a('<p class="loading">'+c.loading_text+"</p>");if(c.username&&typeof c.username=="string"){c.username=[c.username]}var l=function(a){if(typeof c.template==="string"){var b=c.template;for(var d in a){var e=a[d];b=b.replace(new RegExp("{"+d+"}","g"),e===null?"":e)}return b}else return c.template(a)};if(c.loading_text)a(g).append(k);a(g).bind("load",function(){a.getJSON(f(),function(b){if(c.loading_text)k.remove();if(c.intro_text)h.before(i);h.empty();var f=a.map(b.results||b,function(b){var f=c.join_text;if(c.join_text=="auto"){if(b.text.match(/^(@([A-Za-z0-9-_]+)) .*/i)){f=c.auto_join_text_reply}else if(b.text.match(/(^\w+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&\?\/.=]+) .*/i)){f=c.auto_join_text_url}else if(b.text.match(/^((\w+ed)|just) .*/im)){f=c.auto_join_text_ed}else if(b.text.match(/^(\w*ing) .*/i)){f=c.auto_join_text_ing}else{f=c.auto_join_text_default}}var g=b.from_user||b.user.screen_name;var h=b.source;var i="http://"+c.twitter_url+"/"+g;var j=c.avatar_size;var k=b.profile_image_url||b.user.profile_image_url;var l="http://"+c.twitter_url+"/"+g+"/status/"+b.id_str;var m=typeof b.retweeted_status!="undefined";var n=m?b.retweeted_status.user.screen_name:null;var o=d(b.created_at);var p=e(o);var q=m?"RT @"+n+" "+b.retweeted_status.text:b.text;var r=a([q]).linkUrl().linkUser().linkHash()[0];var t='<a class="tweet_user" href="'+i+'">'+g+"</a>";var u=c.join_text?'<span class="tweet_join"> '+f+" </span>":" ";var v=j?'<a class="tweet_avatar" href="'+i+'"><img src="'+k+'" height="'+j+'" width="'+j+'" alt="'+g+'\'s avatar" title="'+g+'\'s avatar" border="0"/></a>':"";var w='<span class="tweet_time"><a href="'+l+'" title="view tweet on twitter">'+p+"</a></span>";var x='<span class="tweet_text">'+a([r]).makeHeart().capAwesome().capEpic()[0]+"</span>";return{item:b,screen_name:g,user_url:i,avatar_size:j,avatar_url:k,source:h,tweet_url:l,tweet_time:o,tweet_relative_time:p,tweet_raw_text:q,tweet_text:r,retweet:m,retweeted_screen_name:n,user:t,join:u,avatar:v,time:w,text:x}});f=a.grep(f,c.filter).slice(0,c.count);h.append(a.map(f.sort(c.comparator),function(a){return"<li>"+l(a)+"</li>"}).join("")).children("li:first").addClass("tweet_first").end().children("li:odd").addClass("tweet_even").end().children("li:even").addClass("tweet_odd");if(c.outro_text)h.after(j);a(g).trigger("loaded").trigger(f.length===0?"empty":"full");if(c.refresh_interval){window.setTimeout(function(){a(g).trigger("load")},2e3*c.refresh_interval)}})}).trigger("load")})}})(jQuery)